<p id="notice"><%= notice %></p>

<div class="min-h-screen bg-gray-100">
<nav x-data="{ open: false }" class="bg-white shadow">
  <div class="max-w-7xl mx-auto px-2 sm:px-4 lg:px-8">
    <div class="flex justify-between h-16">
      <div class="flex px-2 lg:px-0">
        <div class="flex-shrink-0 flex items-center">
          <%= link_to root_path do %>
            <img class="block lg:hidden h-8 w-auto" src="/julia.svg" alt="Julia Packages" />
            <img class="hidden lg:block h-8 w-auto" src="/julia.svg" alt="Julia Packages" />
          <% end %>
        </div>
      </div>
      <div class="flex-1 flex items-center justify-center px-2 lg:ml-6 lg:justify-end">

        <%= form_tag packages_path, class: "max-w-lg w-full lg:max-w-xs", method: "get" do %>
            <label for="search" class="sr-only">Search</label>
            <div class="relative">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <svg class="h-5 w-5 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
                </svg>
              </div>
              <%= text_field_tag :search, params[:search], autocomplete: :off, placeholder: "Search", class: "block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:border-blue-300 focus:shadow-outline-blue sm:text-sm transition duration-150 ease-in-out", tabindex: "1", "x-init" => "$el.focus()" %>
            </div>
        <% end %>

      </div>
      <div class="flex items-center lg:hidden">
        <button @click="open = !open" class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 focus:text-gray-500 transition duration-150 ease-in-out">
          <svg class="h-6 w-6" stroke="currentColor" fill="none" viewBox="0 0 24 24">
            <path :class="{'hidden': open, 'inline-flex': !open }" class="inline-flex" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
            <path :class="{'hidden': !open, 'inline-flex': open }" class="hidden" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>
      <div class="hidden lg:ml-4 lg:flex lg:items-center">
        <div @click.away="open = false" class="ml-4 relative flex-shrink-0" x-data="{ open: false }">
          <div>
            <button @click="open = !open" class="flex text-sm border-2 border-transparent rounded-full focus:outline-none focus:border-gray-300 transition duration-150 ease-in-out">
              <!-- <img class="h-8 w-8 rounded-full" src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80" alt="" /> -->
              <span class="inline-flex items-center justify-center h-8 w-8 rounded-full bg-gray-400">
                <span class="text-sm font-medium leading-none text-white"><%= fa_icon "cog lg" %></span>
              </span>
            </button>
          </div>
          <div x-show="open" x-transition:enter="transition ease-out duration-100" x-transition:enter-start="transform opacity-0 scale-95" x-transition:enter-end="transform opacity-100 scale-100" x-transition:leave="transition ease-in duration-75" x-transition:leave-start="transform opacity-100 scale-100" x-transition:leave-end="transform opacity-0 scale-95" class="origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg">
            <div class="py-1 rounded-md bg-white shadow-xs">
              <a href="#" class="block px-4 py-2 text-sm leading-5 text-gray-700 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 transition duration-150 ease-in-out">Your Profile</a>
              <a href="#" class="block px-4 py-2 text-sm leading-5 text-gray-700 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 transition duration-150 ease-in-out">Settings</a>
              <a href="#" class="block px-4 py-2 text-sm leading-5 text-gray-700 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 transition duration-150 ease-in-out">Sign out</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div :class="{'block': open, 'hidden': !open}" class="hidden lg:hidden">
    <div class="pt-3 pb-2.5 border-t border-gray-200">
      <div class="">
        <a href="#" class="block px-4 py-2 text-base font-medium text-gray-500 hover:text-gray-800 hover:bg-gray-100 focus:outline-none focus:text-gray-800 focus:bg-gray-100 transition duration-150 ease-in-out">Your Profile</a>
        <a href="#" class="mt-1 block px-4 py-2 text-base font-medium text-gray-500 hover:text-gray-800 hover:bg-gray-100 focus:outline-none focus:text-gray-800 focus:bg-gray-100 transition duration-150 ease-in-out">Settings</a>
        <a href="#" class="mt-1 block px-4 py-2 text-base font-medium text-gray-500 hover:text-gray-800 hover:bg-gray-100 focus:outline-none focus:text-gray-800 focus:bg-gray-100 transition duration-150 ease-in-out">Sign out</a>
      </div>
    </div>
  </div>
</nav>

  <div class="py-10">
    <header>
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <!-- <h1 class="text-3xl font-bold leading-tight text-gray-900">
          Dashboard
        </h1> -->

<div class="lg:flex lg:items-center lg:justify-between">
  <div class="flex-1 min-w-0">
    <h2 class="text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:leading-9 sm:truncate">
      <%= @package.name %>.jl
    </h2>
    <% unless @package.description.blank? %>
      <div class="mt-1 flex flex-col sm:mt-0 sm:flex-row sm:flex-wrap">
        <div class="mt-2 flex items-center text-sm leading-5 text-gray-500">
          <%= @package.description %>
        </div>
      </div>
    <% end %>
  </div>
  <div class="mt-5 flex lg:mt-0 lg:ml-4">

    <div class="mt-4 flex-shrink-0 flex lg:mt-0 lg:ml-4">
      <% if @package.website.present? %>
        <%
          used_website = @package.website
          unless used_website[/\Ahttp:\/\//] || used_website[/\Ahttps:\/\//]
            used_website = "http://#{used_website}"
          end
        %>
        <span class="mr-3 shadow-sm rounded-md">
          <a href="<%= used_website %>" class="inline-flex items-center px-4 py-2 border border-gray-300 text-sm leading-5 font-medium rounded-md text-gray-700 bg-white hover:text-gray-500 focus:outline-none focus:shadow-outline-blue focus:border-blue-300 active:text-gray-800 active:bg-gray-50 transition duration-150 ease-in-out">
            Website
          </a>
        </span>
      <% end %>
      <span class="shadow-sm rounded-md">
        <a href="<%= @package.github_url %>" class="inline-flex items-center px-4 py-2 border border-transparent text-sm leading-5 font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-500 focus:outline-none focus:shadow-outline-indigo focus:border-indigo-700 active:bg-indigo-700 transition duration-150 ease-in-out">
          Github
        </a>
      </span>
    </div>

  </div>
</div>

      </div>
    </header>
    <main>
      <div class="max-w-7xl mx-auto sm:px-6 lg:px-8">
        <div class="px-4 pt-5 mt-0.5 pb-5 sm:px-0">

<div>
  <div class="mt-3 grid grid-cols-1 rounded-lg bg-white overflow-hidden shadow md:grid-cols-3">
    <div>
      <div class="px-4 py-5 sm:p-6">
        <dl>
          <dt class="text-sm leading-5 font-medium text-gray-500 truncate">
            Popularity
          </dt>
          <dd class="mt-1 text-2xl leading-9 font-semibold text-gray-900">
            <%= @package.stars %> <%= @package.stars == 1 ? "Star" : "Stars" %>
          </dd>
        </dl>
      </div>
    </div>
    <div class="border-t border-gray-200 md:border-0 md:border-l">
      <div class="px-4 py-5 sm:p-6">
        <dl>
          <dt class="text-sm leading-5 font-medium text-gray-500 truncate">
            Updated Last
          </dt>
          <dd class="mt-1 text-2xl leading-9 font-semibold text-gray-900">
            <%
              updated_string = ( time_ago_in_words @package.updated ).titleize
              updated_string.gsub! "Over ", ""
              updated_string.gsub! "About ", ""
              updated_string.gsub! "Almost ", ""
            %>

            <%= updated_string %> Ago
          </dd>
        </dl>
      </div>
    </div>
    <div class="border-t border-gray-200 md:border-0 md:border-l">
      <div class="px-4 py-5 sm:p-6">
        <dl>
          <dt class="text-sm leading-5 font-medium text-gray-500 truncate">
            Started In
          </dt>
          <dd class="mt-1 text-2xl leading-9 font-semibold text-gray-900">
            <%= @package.created.strftime("%B %Y") %>
          </dd>
        </dl>
      </div>
    </div>
  </div>
</div>

</div>
          <% unless @package.readme.is_empty %>
            <div class="px-4 pt-4 pb-2 sm:px-0">

              <div class="bg-white overflow-hidden shadow rounded-lg">
                <div class="py-8 px-10">
                  <%
                    readme_html = @package.readme.html
                    readme_html.gsub! 'href="#', 'href="#user-content-'

                    readme_html.gsub! /(?<=src\=\")(?!(http|https):)/, @package.github_url + "/raw/master/"

                    readme_html.gsub! "/raw/master//", "/raw/master/"

                    readme_html.gsub! /(?<=href\=\")(?!(http|https):)/, @package.github_url + "/blob/master/"

                    readme_html.gsub! "/blob/master//", "/blob/master/"
                  %>

                    <%= raw readme_html %>
                </div>
              </div>
            </div>
          <% end %>
        </div>
      </main>
    </div>
</div>
